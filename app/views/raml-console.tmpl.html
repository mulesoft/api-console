<article role="api-console">
  <section role="error" ng-if="parseError">
    {{parseError}}
  </section>

  <h1>{{api.title}}</h1>

  <div class='accordion' role="resources">
    <div class='accordion-group' role="resource" ng-repeat="resource in api.resources">
      <resource-summary class='accordion-heading accordion-toggle' ng-click='resource.isOpen = !resource.isOpen'></resource-summary>
      <div class='accordion-body' ng-show='resource.isOpen'>
        <div class='accordion-inner'>
          <div class='accordion' role="methodSummaries">
            <div class='accordion-group' role="methodSummary" ng-repeat="method in resource.methods">
              <div class='accordion-heading accordion-toggle' ng-click='method.isOpen = !method.isOpen'>
                <i ng-class="{'icon-caret-right': !method.isOpen, 'icon-caret-down': method.isOpen}"></i>
                <span role="method">{{method.verb}}</span>
                <path-builder></path-builder>
                <div class="pull-right">
                  <button role="try-it-tab" class="btn" ng-click="method.currentTab='tryIt'; method.isOpen && $event.stopPropagation(); ">Try It</button>
                  <i class="icon-file-alt documentation" ng-click="method.currentTab='documentation'; method.isOpen && $event.stopPropagation();"></i>
                </div>
              </div>
              <div class='accordion-body' ng-show='method.isOpen'>
                <div class='accordion-inner'>
                  <section role='documentation' ng-show="method.currentTab == 'documentation'">
                    <p ng-show="method.description">Description: {{method.description}}</p>

                    <h4 class='selector'>
                      Parameters
                    </h4>
                    <parameter-table heading='URI Parameters' role='uri-parameters' parameters='resource.uriParameters'></parameter-table>
                    <parameter-table heading='Query Parameters' role='query-parameters' parameters='method.queryParameters'></parameter-table>
                  </section>

                  <section class="try-it" ng-show="method.currentTab == 'tryIt'" ng-controller="TryItController">
                    <button role="try-it" class="btn btn-primary" ng-click="apiClient.execute()">
                      Try It
                    </button>

                    <div class="response" ng-show="apiClient.response">
                      <h3>Response</h3>
                      <div class="status">
                        <h4>Status</h4>
                        <span class="response-value">{{apiClient.response.status}}</span>
                      </div>
                      <div class="headers">
                        <h4>Headers</h4>
                        <ul class="response-value">
                          <li ng-repeat="(header, value) in apiClient.response.headers">
                            <span class="header-key">{{header}}:</span>
                            <span class="header-value">{{value}}</span>
                          </li>
                        </ul>
                      </div>
                      <div class="body">
                        <h4>Body</h4>
                        <div class="response-value">
                          {{apiClient.response.body}}
                        </div>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</article>
